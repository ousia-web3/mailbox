# 윈도우 작업 스케줄러 완전 자동화 설정 가이드

윈도우 작업 스케줄러를 사용하여 메일 발송을 자동화할 때, 화면 보호기(잠금) 상태나 전원 꺼짐, 절전 모드 등에서 발생할 수 있는 문제와 해결 방법을 정리한 문서입니다.

## 1. 컴퓨터가 꺼져 있는 경우 (Power Off)

**원칙적으로 전원이 완전히 꺼진 상태에서는 윈도우 작업 스케줄러가 작동할 수 없습니다.**

### 해결 방안

1. **BIOS/UEFI 자동 부팅 설정 (RTC Alarm)**

   - 컴퓨터 부팅 시 `Del` 또는 `F2` 키를 눌러 BIOS 설정으로 진입합니다.
   - `Power Management` 또는 `APM Configuration` 메뉴에서 `Resume by Alarm` (또는 `RTC Alarm Power On`) 기능을 활성화(Enable)합니다.
   - 원하는 시간에 컴퓨터가 자동으로 켜지도록 시간을 설정합니다. (작업 스케줄 시간보다 5~10분 전으로 설정 권장)

2. **Wake-on-LAN (WOL) 활용**

   - 공유기 설정을 통해 외부에서 신호를 보내 컴퓨터를 켤 수 있습니다.
   - 스마트폰 앱이나 다른 기기를 통해 원격으로 부팅한 후 작업이 실행되도록 합니다.

3. **환경 이전 (권장)**
   - 24시간 켜져 있는 환경으로 작업을 이전하는 것이 가장 확실합니다.
   - 예: 사내 서버, NAS, 개인용 라즈베리파이, 또는 클라우드 서버(AWS, Google Cloud 등) 활용.

---

## 2. 화면 잠금 또는 로그아웃 상태 (Logged Out / Locked)

기본 설정은 "사용자가 로그온할 때만 실행"으로 되어 있어, 화면이 잠기거나 로그아웃되면 작업이 실패합니다.

### 해결 방안

1. **작업 스케줄러 속성 변경**
   - 해당 작업을 더블 클릭하여 속성 창을 엽니다.
   - **[일반]** 탭 하단의 보안 옵션을 확인합니다.
   - **'사용자가 로그온해 있는지 여부에 관계없이 실행(R)'**을 선택합니다.
   - **'가장 높은 수준의 권한으로 실행(I)'**을 체크합니다 (권한 문제 방지).
   - 설정 저장 시 윈도우 계정의 **비밀번호**를 입력해야 합니다.

> **주의**: '암호를 저장하지 않음' 옵션은 네트워크 드라이브나 특정 리소스 접근 시 권한 오류가 발생할 수 있으므로 주의해야 합니다.

---

## 3. 절전 모드 상태 (Sleep Mode)

컴퓨터가 켜져 있더라도 절전 모드(Sleep) 상태라면 작업이 시작되지 않을 수 있습니다.

### 해결 방안

1. **작업 스케줄러 조건 설정**

   - 작업 속성 -> **[조건]** 탭으로 이동합니다.
   - [전원] 섹션에서 **'이 작업을 실행하기 위해 컴퓨터의 절전 모드 종료(W)'** 항목을 반드시 체크합니다.

2. **윈도우 전원 옵션 확인**
   - [제어판] -> [전원 옵션] -> [설정 변경] -> [고급 전원 관리 옵션 설정 변경]
   - **[절전]** -> **[절전 모드 해제 타이머 허용]**이 '사용'으로 설정되어 있는지 확인합니다.

---

## 4. 배치 파일(.bat) 및 스크립트 실행 시 팁

화면이 보이지 않는 백그라운드 상태에서 실행될 때 흔히 발생하는 오류를 방지하기 위한 팁입니다.

1. **절대 경로 사용**

   - 배치 파일 내부에서 파일을 호출할 때 상대 경로(`.\file.txt`) 대신 절대 경로(`C:\Project\file.txt`)를 사용하세요.
   - 예: `python main.py` (X) -> `C:\Python39\python.exe C:\Project\main.py` (O)

2. **시작 위치(Start In) 설정**

   - 작업 스케줄러 -> **[동작]** 탭 -> 편집
   - **'시작 위치(옵션)(T)'** 항목에 배치 파일이 위치한 **폴더 경로**를 입력해 줍니다. (예: `C:\Users\HANA\Desktop\mailbox`)
   - 이 설정을 해야 스크립트가 해당 폴더를 기준으로 파일을 찾을 수 있습니다.

3. **로그 남기기**
   - 화면이 보이지 않으므로 실행 결과를 파일로 남기도록 배치 파일을 작성하세요.
   - 예: `python job.py >> C:\Logs\log.txt 2>&1`
