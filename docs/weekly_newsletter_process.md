# 주간 뉴스레터 발송 프로세스 및 관련 파일 정리

## 1. 주간 뉴스레터 발송 프로세스

주간 뉴스레터 시스템은 지난 한 주간(월요일~일요일) 수집된 일일 뉴스 데이터를 취합하여, AI를 통해 중요 뉴스를 선별하고 인사이트를 도출하여 발송하는 구조로 동작합니다.

### 상세 단계

1.  **실행 (Execution)**

    - 사용자가 `run_weekly_newsletter.bat` 스크립트를 실행하여 프로세스를 시작합니다.
    - 이 스크립트는 `weekly_generator.py`를 호출합니다.

2.  **데이터 로드 (Data Loading)**

    - `weekly_generator.py`가 실행되면 `date_utils.py`를 통해 지난주 월요일부터 일요일까지의 날짜 범위를 계산합니다.
    - `archives/daily/{년}/{월}/` 경로에 저장된 `daily_news_{날짜}.json` 파일들을 순차적으로 읽어들입니다.
    - 읽어들인 일일 뉴스 데이터를 주제별(IT, AI, 여행 등)로 통합합니다.

3.  **AI 큐레이션 및 요약 (AI Curation & Summarization)**

    - **뉴스 선별**: 통합된 뉴스 목록에서 `NewsSummarizer`를 사용해 주제별로 가장 중요한 'Top 5 뉴스'를 선별합니다.
    - **주제 요약**: 선별된 뉴스를 바탕으로 해당 주제의 주간 동향을 요약합니다.
    - **Weekly Insight 생성**: 모든 주제의 요약을 종합하여 '핵심 키워드', '주간 트렌드', '비즈니스 시사점'이 포함된 주간 인사이트를 생성합니다.

4.  **HTML 생성 (HTML Generation)**

    - 선별된 뉴스, 주제별 요약, Weekly Insight 데이터를 바탕으로 이메일 본문(HTML)을 생성합니다.
    - HTML 템플릿은 `weekly_generator.py` 내부에 포함되어 있습니다.

5.  **이메일 발송 (Sending)**

    - `EmailSender` 모듈을 사용하여 생성된 HTML을 이메일로 발송합니다.
    - 메일 제목: `[IT본부] 하나투어 주간 뉴스레터`

6.  **아카이빙 (Archiving)**
    - 발송된 주간 뉴스레터 HTML 파일은 `archives/weekly/{년}/` 폴더에 `weekly_newsletter_{날짜}.html` 형태로 저장됩니다.

---

## 2. 관련 파일 목록

주간 뉴스레터 시스템과 직접적으로 관련된 파일들은 다음과 같습니다.

| 파일명                        | 경로               | 설명                                                                                                |
| :---------------------------- | :----------------- | :-------------------------------------------------------------------------------------------------- |
| **weekly_generator.py**       | `root`             | **핵심 로직 파일**. 데이터 로드, AI 처리 호출, HTML 생성, 발송 등 주간 레터의 전 과정을 제어합니다. |
| **run_weekly_newsletter.bat** | `root`             | 주간 뉴스레터 생성을 간편하게 실행하기 위한 윈도우 배치 스크립트입니다.                             |
| **news_summarizer.py**        | `root`             | AI(OpenAI API)를 호출하여 뉴스 선별, 요약, 인사이트 생성을 수행하는 모듈입니다.                     |
| **email_sender.py**           | `root`             | SMTP를 통해 이메일을 실제로 발송하는 기능을 담당합니다.                                             |
| **date_utils.py**             | `root`             | 지난주 날짜 범위 계산 등 날짜 관련 유틸리티 함수를 제공합니다.                                      |
| **archives/daily/**           | `archives/daily/`  | 주간 레터의 원천 데이터가 되는 일일 뉴스 데이터(JSON)가 저장된 경로입니다.                          |
| **archives/weekly/**          | `archives/weekly/` | 생성된 주간 뉴스레터 결과물(HTML)이 저장되는 경로입니다.                                            |

---

## 3. 실행 방법

1.  바탕화면의 `mailbox` 폴더로 이동합니다.
2.  `run_weekly_newsletter.bat` 파일을 더블 클릭하여 실행합니다.
3.  콘솔 창에서 진행 상황(데이터 로드 -> AI 큐레이션 -> 발송)을 확인할 수 있습니다.

## 4. 참고 사항

- 주간 뉴스레터는 **일일 뉴스 데이터(`archives/daily/`)**에 의존합니다. 따라서 일일 뉴스 수집이 정상적으로 이루어지지 않았다면 주간 레터의 내용이 빈약할 수 있습니다.
- 웹 인터페이스(`web_app.py`)와는 별도로 동작하는 독립적인 스크립트 구조를 가지고 있습니다.
